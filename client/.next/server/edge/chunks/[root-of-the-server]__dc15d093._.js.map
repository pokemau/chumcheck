{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { jwtVerify } from 'jose';\nimport { User } from './lib/types';\nimport { Role } from './lib/enums';\n\nexport async function middleware(request: NextRequest) {\n  const accessToken = request.cookies.get('Access')?.value;\n\n  if (!accessToken) {\n    return NextResponse.next();\n  }\n\n  try {\n    const secret = new TextEncoder().encode(process.env.JWT_SECRET!);\n\n    const { payload } = await jwtVerify<{\n      sub: string;\n      email: string;\n      role: Role;\n      firstName: string;\n      lastName: string;\n    }>(accessToken, secret);\n\n    const user: User = {\n      id: Number(payload.sub),\n      email: payload.email,\n      role: payload.role!,\n      firstName: payload.firstName,\n      lastName: payload.lastName\n    };\n\n    const requestHeaders = new Headers(request.headers);\n    requestHeaders.set('x-user-data', JSON.stringify(user));\n\n    return NextResponse.next({\n      request: {\n        headers: requestHeaders,\n      },\n    });\n  } catch (error) {\n    console.error('JWT verification failed:', error);\n    return NextResponse.next();\n  }\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico).*)',\n  ],\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAIO,eAAe,WAAW,OAAoB;IACnD,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IAEnD,IAAI,CAAC,aAAa;QAChB,OAAO,4TAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,IAAI;QACF,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU;QAE9D,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,iNAAA,CAAA,YAAS,AAAD,EAM/B,aAAa;QAEhB,MAAM,OAAa;YACjB,IAAI,OAAO,QAAQ,GAAG;YACtB,OAAO,QAAQ,KAAK;YACpB,MAAM,QAAQ,IAAI;YAClB,WAAW,QAAQ,SAAS;YAC5B,UAAU,QAAQ,QAAQ;QAC5B;QAEA,MAAM,iBAAiB,IAAI,QAAQ,QAAQ,OAAO;QAClD,eAAe,GAAG,CAAC,eAAe,KAAK,SAAS,CAAC;QAEjD,OAAO,4TAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;gBACP,SAAS;YACX;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,4TAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}